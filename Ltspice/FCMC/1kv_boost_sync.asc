Version 4
SHEET 1 2076 868
WIRE 48 0 -32 0
WIRE 224 0 128 0
WIRE 256 0 224 0
WIRE 336 0 320 0
WIRE 352 0 336 0
WIRE 432 0 416 0
WIRE 448 0 432 0
WIRE 528 0 512 0
WIRE 544 0 528 0
WIRE 640 0 608 0
WIRE 720 0 704 0
WIRE 736 0 720 0
WIRE 832 0 800 0
WIRE 1248 0 832 0
WIRE 1248 80 1248 0
WIRE 336 112 336 0
WIRE 432 112 432 0
WIRE 528 112 528 0
WIRE 640 112 640 0
WIRE 720 112 720 0
WIRE 832 112 832 0
WIRE -32 176 -32 0
WIRE 224 240 224 0
WIRE 256 240 224 240
WIRE 336 240 336 176
WIRE 352 240 336 240
WIRE 432 240 432 176
WIRE 448 240 432 240
WIRE 528 240 528 176
WIRE 560 240 528 240
WIRE 640 240 640 176
WIRE 720 240 720 176
WIRE 752 240 720 240
WIRE 832 240 832 176
WIRE 1248 240 1248 160
WIRE 1248 240 832 240
WIRE -32 288 -32 256
WIRE 720 288 704 288
WIRE 320 368 320 288
WIRE 416 368 416 288
WIRE 512 368 512 288
WIRE 624 368 624 288
WIRE 720 368 720 288
WIRE 816 368 816 288
WIRE 416 448 320 448
WIRE 512 448 416 448
WIRE 624 448 512 448
WIRE 720 448 624 448
WIRE 816 448 720 448
FLAG -32 288 0
FLAG 272 288 0
FLAG 368 288 0
FLAG 464 288 0
FLAG 576 288 0
FLAG 656 288 0
FLAG 768 288 0
FLAG 416 448 0
FLAG 336 0 C1+
FLAG 336 240 C1-
FLAG 432 0 C2+
FLAG 528 0 C3+
FLAG 640 0 C4+
FLAG 720 0 C5+
FLAG 832 0 C6+
FLAG 432 240 C2-
FLAG 528 240 C3-
FLAG 640 240 C4-
FLAG 720 240 C5-
FLAG 832 176 C6-
FLAG 1248 240 0
FLAG 224 0 Vl
FLAG 160 288 0
SYMBOL voltage -32 160 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 100
SYMBOL cap 320 112 R0
SYMATTR InstName C2
SYMATTR Value {4*cfly}
SYMATTR SpiceLine Rser={esr_fly}
SYMATTR SpiceLine2 ic = 166
SYMBOL cap 416 112 R0
SYMATTR InstName C3
SYMATTR Value {3*cfly}
SYMATTR SpiceLine Rser={esr_fly}
SYMATTR SpiceLine2 ic = 333
SYMBOL cap 512 112 R0
SYMATTR InstName C4
SYMATTR Value {2*cfly}
SYMATTR SpiceLine Rser={esr_fly}
SYMATTR SpiceLine2 ic = 500
SYMBOL cap 624 112 R0
SYMATTR InstName C5
SYMATTR Value {cfly}
SYMATTR SpiceLine Rser={esr_fly}
SYMATTR SpiceLine2 ic = 666
SYMBOL cap 704 112 R0
SYMATTR InstName C6
SYMATTR Value {cfly}
SYMATTR SpiceLine Rser={esr_fly}
SYMATTR SpiceLine2 ic = 833
SYMBOL cap 816 112 R0
SYMATTR InstName C7
SYMATTR Value {6*cfly}
SYMATTR SpiceLine Rser={esr_fly}
SYMATTR SpiceLine2 ic = 1000
SYMBOL diode 256 16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL diode 352 16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL diode 448 16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMBOL diode 544 16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMBOL diode 640 16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D5
SYMBOL diode 736 16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMBOL sw 240 240 R270
WINDOW 3 24 96 Invisible 2
SYMATTR InstName S1
SYMBOL sw 336 240 R270
WINDOW 3 24 96 Invisible 2
SYMATTR Value SW2
SYMATTR InstName S2
SYMBOL sw 544 240 R270
WINDOW 3 24 96 Invisible 2
SYMATTR Value SW2
SYMATTR InstName S4
SYMBOL sw 624 240 R270
WINDOW 3 24 96 Invisible 2
SYMATTR InstName S5
SYMBOL sw 736 240 R270
WINDOW 3 24 96 Invisible 2
SYMATTR Value SW2
SYMATTR InstName S6
SYMBOL sw 432 240 R270
WINDOW 3 24 96 Invisible 2
SYMATTR InstName S3
SYMBOL voltage 320 352 R0
WINDOW 3 -478 145 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 5 0 100p 100p {Ton} {T})
SYMATTR InstName V2
SYMBOL ind 32 16 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 15µ
SYMATTR SpiceLine Rser=0.01
SYMBOL voltage 416 352 R0
WINDOW 3 -577 175 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 5 {T/6} 100p 100p {Ton} {T})
SYMATTR InstName V3
SYMBOL voltage 512 352 R0
WINDOW 3 -675 202 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 5 {T/6*2} 100p 100p {Ton} {T})
SYMATTR InstName V4
SYMBOL voltage 624 352 R0
WINDOW 3 -788 231 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 5 {T/6*3} 100p 100p {Ton} {T})
SYMATTR InstName V5
SYMBOL voltage 720 352 R0
WINDOW 3 -876 258 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 5 {T/6*4} 100p 100p {Ton} {T})
SYMATTR InstName V6
SYMBOL voltage 816 352 R0
WINDOW 3 -974 288 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 5 {T/6*5} 100p 100p {Ton} {T})
SYMATTR InstName V7
SYMBOL res 1232 64 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL ind 144 48 R0
SYMATTR InstName L2
SYMATTR Value 48.8µ
SYMBOL cap 144 144 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMATTR SpiceLine2 ic = 166
SYMBOL res 144 192 R0
SYMATTR InstName R2
SYMATTR Value 5
TEXT -328 392 Left 2 !.param Don={9/10} T=13.9u Ton= Don*T
TEXT 552 728 Left 2 !.model SW SW(Ron=1m Roff=1MEG Vt=2.5)
TEXT -328 448 Left 2 !.model D D(Ron=10m Roff=1MEG Vfwd=0.7)
TEXT -232 752 Left 2 !.tran 0 600m 10m uic
TEXT 416 528 Left 2 ;.ic V(c1+)=200 V(c2+)=400 V(c3+)=600 V(c4+)=800 V(c5+)=1000 V(c6+)=1200
TEXT 424 568 Left 2 !.ic V(c1-)=0  V(c2-)=0 V(c3-)=0 V(c4-)=0 V(c5-)=0
TEXT -328 360 Left 2 !.param cfly = 0.5u esr_fly =1m
TEXT 552 688 Left 2 !.model SW2 SW(Ron=10m Roff=1MEG Vt=2.5)
